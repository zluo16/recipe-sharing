<h1><%= @recipe.name %></h1>
<h4>made by <%= @author.first_name %></h4>

<div>
  <% if current_user == @recipe.author%>
    <a class="btn" href="<%= edit_recipe_path(@recipe)%>">Edit</a>
    <a class="btn" href="<%= edit_recipe_path(@recipe)%>">Delete Recipe</a>
  <% else %>
  <!-- THIS BUTTON IS NOT YET WORKING WORKING ON IT NOW -->
    <% if logged_in? %>
      <% if current_user.saved_recipes.include?(@recipe) %>
        <%= link_to "Unsave", saver_recipe_path(SaverRecipe.find_by(saver_id: current_user.id, saved_recipe_id: @recipe.id)), method: :delete, class:'btn' %>
      <% else %>
        <%= form_for SaverRecipe.new do |f| %>
        <%= f.hidden_field :saver_id, :value => current_user.id %>
        <%= f.hidden_field :saved_recipe_id, :value => @recipe.id %>
        <%= f.submit "Save Recipe", class:'btn'%>
        <% end %>
      <% end %>
    <% else %>
      <a class="btn" onclick="Materialize.toast('Please sign up or sign in to save this recipe.', 4000)">Save Recipe</a>
    <% end %>
  <% end %>
</div><br><br>

<div>
  <%= image_tag @recipe.image.url(:medium) if @recipe.image? %>
</div>
<div>
  <h5>Dietary Compliance</h5>
  <% if @recipe.vegetarian == true%>
    <p>Vegetarian</p>
  <% end %>
  <% if @recipe.vegan == true%>
    <p>Vegan</p>
  <% end %>
  <% if @recipe.gluten_free == true%>
    <p>Gluten-Free</p>
  <% end %>
  <% if @recipe.low_carb == true%>
    <p>Low-Carb</p>
  <% end %>
  <% if @recipe.kosher == true%>
    <p>Kosher</p>
  <% end %>
  <% if @recipe.halal == true%>
    <p>Halal</p>
  <% end %>
</div>


<div>
  <h5>Overview </h5>
  <p>Prep Time: <%= @recipe.prep_time %> minutes</p>
  <p>Cook Time: <%= @recipe.cook_time %> minutes</p>
  <p><strong>Total Time: <%= "#{@recipe.prep_time + @recipe.cook_time}" %> minutes</strong></p>
</div>


<div>
  <h5>Ingredients: </h5>
  <% if @recipe.ingredients.count > 0 %>
    <ul>
      <% @recipe.recipe_ingredients.each do |i| %>
        <li><%= i.quantity %> <%= i.units%> â€” <%= i.ingredient.name %> <%= link_to "Delete", i, method: :delete %></li>
      <% end %>
    </ul>
  <% end %>
  <% if current_user == @recipe.author%>
  <!-- Modal Trigger -->
    <a class="modal-trigger waves-effect waves-light btn" href="#add_recipe_ingredient_modal">Add Ingredient</a>

    <!-- Modal Structure -->
    <div id="add_recipe_ingredient_modal" class="modal modal-fixed-footer">
      <div class="modal-content">
        <h4>Add Ingredient to <%=@recipe.name%></h4>
        <%= form_for(@recipe_ingredient) do |t| %>
          <%= t.hidden_field :recipe_id, value: @recipe.id %><br>
          <%= t.collection_select :ingredient_id, Ingredient.order(:name), :id, :name, { prompt: "Choose an ingredient" }%><br>
          <%= t.number_field :quantity, placeholder: 'quantity' %>
          <%= t.select :units, ['cup(s)', 'gram(s)', 'kilogram(s)', 'liter(s)', 'mililiter(s)', 'pound(s)', 'ounce(s)', 'pint(s)', 'teaspoon(s)', 'tablespoon(s)'], { prompt: "Choose a unit of measure" }%><br><br>
          <%= t.submit "Add Ingredient to Recipe", class:'btn' %>
        <% end %>
      </div>
    </div>
  <% end %>


</div>


<div>
  <h5>Instructions: </h5>
  <%= simple_format @recipe.instructions %>
</div><br>
